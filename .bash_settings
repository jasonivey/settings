#!/bin/bash

# environment variables
export PATH=$PATH:$HOME/settings:$HOME/scripts

if [ "$(uname)" == "Darwin" ]; then

    # for use with the GO language installation
    export GOROOT=/usr/local/go
    export GOPATH=$HOME/scripts/go

    export PROMPT_COMMAND='echo -ne "\033]0;${PWD/#$HOME/~}\007"'

elif [ "$(uname -s)" == "Linux" ]; then

    # for use with the GO language installation
    export GOROOT=/usr/lib/go
    export GOPATH=$HOME/scripts/go

    # prompt_command is a callback which is called right before the prompt is printed
    # this sets the tab title to the current working directory in iTerm2
    if [ "$(lsb_release -sc)" == "precise" ]; then
        export PROMPT_COMMAND='echo -ne "\033]0;${PWD/#$HOME/~}\007"'
    else
        export PROMPT_COMMAND='echo -ne "\033]0;${PWD/#$HOME/\~}\007"'
    fi

fi

# setting the PS1 environment variable will set the prompt to a specific color and the working directory
function set_prompt {
    local BLACK="\[\033[0;30m\]"
    local BLACKBOLD="\[\033[1;30m\]"
    local RED="\[\033[0;31m\]"
    local REDBOLD="\[\033[1;31m\]"
    local GREEN="\[\033[0;32m\]"
    local GREENBOLD="\[\033[1;32m\]"
    local YELLOW="\[\033[0;33m\]"
    local YELLOWBOLD="\[\033[1;33m\]"
    local BLUE="\[\033[0;34m\]"
    local BLUEBOLD="\[\033[1;34m\]"
    local PURPLE="\[\033[0;35m\]"
    local PURPLEBOLD="\[\033[1;35m\]"
    local CYAN="\[\033[0;36m\]"
    local CYANBOLD="\[\033[1;36m\]"
    local WHITE="\[\033[0;37m\]"
    local WHITEBOLD="\[\033[1;37m\]"
    local RESETCOLOR="\[\e[00m\]"

    export PS1="$BLUE\w$RED"'$(vcprompt -f %b)'"$BLUE â†’ $RESETCOLOR"
    #export PS1='\w$(vcprompt -f %b)> '
}

if [ "$(uname -s)" == "Linux" ]; then
    test -r $HOME/.dircolors && eval "$(dircolors $HOME/.dircolors)"
fi

# utility function to generate cscope output
function set_cscope {
    local CWD=`pwd`
    pushd $CWD > /dev/null
    cd /
    eval `find $CWD -name '*.c' -o -name '*.cpp' -o -name '*.h' -o -name '*.hpp' > $CWD/cscope.files`
    popd > /dev/null
    eval `cscope -b`
}

# User specific aliases and functions
alias df='df -h'
alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'
alias edit='vim'
alias view='vim'
alias vi='vim'
alias cpwp='rsync -aP'
alias mvwp='rsync -aP --remove-source-files'
alias update-path='export PATH=$PATH:`pwd`'
alias waf-clean='rm -rf .waf-* build pyenv .lock-*'
alias pylint='pylint -r n --rcfile=~/settings/pylintrc'
alias set-cscope='set_cscope'

if [ "$(uname)" == "Darwin" ]; then
    alias ls='ls -laG'
    alias dir='ls -laG'
elif [ "$(uname -s) 1 5)" == "Linux" ]; then
    alias ls='ls -la --color=auto'
    alias dir='ls -la --color=auto'
fi

# functions to set the color of the tab in iTerm2
function tab-blank() { echo -n -e "\033]6;1;bg;*;default\a" ; }
function tab-lime() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;green;brightness;255\a" ; }
function tab-red() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;255\a" ; }
function tab-blue() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;blue;brightness;255\a" ; }
function tab-yellow() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;255\a\033]6;1;bg;green;brightness;255\a\033]6;1;bg;blue;brightness;0\a" ; }
function tab-purple() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;255\a\033]6;1;bg;green;brightness;0\a\033]6;1;bg;blue;brightness;255\a" ; }
function tab-orange() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;255\a\033]6;1;bg;green;brightness;128\a\033]6;1;bg;blue;brightness;0\a" ; }
function tab-aqua() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;0\a\033]6;1;bg;green;brightness;255\a\033]6;1;bg;blue;brightness;255\a" ; }
function tab-redder() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;128\a\033]6;1;bg;green;brightness;0\a\033]6;1;bg;blue;brightness;0\a" ; }
function tab-olive() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;128\a\033]6;1;bg;green;brightness;128\a\033]6;1;bg;blue;brightness;0\a" ; }
function tab-green() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;0\a\033]6;1;bg;green;brightness;128\a\033]6;1;bg;blue;brightness;0\a" ; }
function tab-teal() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;0\a\033]6;1;bg;green;brightness;128\a\033]6;1;bg;blue;brightness;128\a" ; }
function tab-navy() { echo -n -e "\033]6;1;bg;*;default\a\033]6;1;bg;red;brightness;0\a\033]6;1;bg;green;brightness;0\a\033]6;1;bg;blue;brightness;128\a" ; }

#if [ -e "$HOME/settings/.bash_color" -a -n $TERM_PROGRAM ]; then
if [ -e "$HOME/settings/.bash_color" ]; then
    tab-$(head -n 1 $HOME/settings/.bash_color)
fi

set_prompt

# for each new bash shell print out the hostname and network information
echo 'Hostname:         '`hostname`
python $HOME/scripts/network_info.py
