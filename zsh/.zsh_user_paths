#!/usr/bin/env zsh
# vim: awa:sts=4:ts=4:sw=4:et:cin:fdm=manual:tw=120:ft=zsh

add_dir_to_path() {
    [ -d "$1" ] && export PATH="$1:$PATH"
}

export PATH=$PATH:.
add_dir_to_path "/usr/local/sbin"
add_dir_to_path "/usr/local/bin"
add_dir_to_path "$HOME/settings"
add_dir_to_path "$HOME/scripts"
add_dir_to_path "$HOME/.local/bin"
add_dir_to_path "$HOME/.cargo/bin"

# For using a2x for manpage generation
[ -e "/usr/local/etc/xml/catalog" ] && export XML_CATALOG_FILES="/usr/local/etc/xml/catalog"

if [[ "$(uname)" == "Darwin" ]] then
    # Setup the perl environment
    [ -e "$HOME/perl5/perlbrew/etc/bashrc" ] && source "$HOME/perl5/perlbrew/etc/bashrc"

    # Setup JAVA environment variables
    [ -x "/usr/libexec/java_home" ] && export JAVA_HOME=$(/usr/libexec/java_home)

    # Setup LLVM/clang C++ environment variables
    if [[ -d "/usr/local/opt/llvm/lib" ]] then
        export LDFLAGS="-L/usr/local/opt/llvm/lib"
        export CPPFLAGS="-I/usr/local/opt/llvm/include"
        add_dir_to_path "/usr/local/opt/llvm/bin"
    fi

    add_dir_to_path "/usr/local/opt/unzip/bin"
    add_dir_to_path "/usr/local/opt/coreutils/libexec/gnubin"
    add_dir_to_path "/usr/local/opt/make/libexec/gnubin"
    add_dir_to_path "/usr/local/opt/grep/libexec/gnubin"
    add_dir_to_path "/usr/local/opt/gnu-sed/libexec/gnubin"
    add_dir_to_path "/usr/local/opt/gnu-getopt/bin"

    # Setup ruby binaries before system ruby
    add_dir_to_path "/usr/local/opt/ruby/bin"

    # Setup Python-3.7 environment variables
    add_dir_to_path "$HOME/Library/Python/3.7/bin"

    # Setup MacVim environment variables
    add_dir_to_path "/Applications/MacVim.app/Contents/bin"
elif [[ "$(uname -s)" == "Linux" ]] then
    if [[ -d "/usr/lib/jvm/java-11-openjdk-amd64" ]] then
        # Setup JAVA environment variables
        export JAVA_HOME="/usr/lib/jvm/java-11-openjdk-amd64"
        add_dir_to_path "$JAVA_HOME/bin"
    fi
fi

# Always use vim as the editor of choice -- the only thing we can depend on always being installed!
export EDITOR='vim'

# RipGrep needs to know where its configuration file is located
[ -e "$HOME/.config/ripgrep/.ripgreprc" ] && export RIPGREP_CONFIG_PATH=$HOME/.config/ripgrep/.ripgreprc

# Setup golang environment variables
if [[ -d "/usr/local/go" ]] then
    export GOROOT=/usr/local/go
    add_dir_to_path "$HOME/go/bin"
    add_dir_to_path "$GOROOT/bin"
fi
